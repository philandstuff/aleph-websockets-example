To run:

./run_this

To interact:

Browse to http://localhost:8080 in a couple of different browser tabs -- browser choice seems to matter here; Firefox 18.0.1 didn't work but safari 5.1.7 did.

Open the javascript error console and type:

ws.send("message");

The message should be printed in all browsers.
